import{d as A,r as p,o as d,c as I,w as u,x as H,p as L,u as l,f as s,k as y,h as n,m as O,s as U,t as F,e as b,i as D,q as R,a as E,b as $,y as j,j as N,g as K,F as q,M as T,z as J,n as G}from"./index.2bfdadc6.js";import{g as z}from"./go_router.30e3be2a.js";import{_ as P}from"./f_theme.vue_vue_type_script_setup_true_lang.a83fb8cb.js";import{_ as Q}from"./_plugin-vue_export-helper.cdc0426e.js";const S=A({__name:"f_point",props:{count:{}},setup(f){const t=f;return(_,r)=>{const e=p("a-badge");return d(),I(e,{class:"f_point_com",count:t.count,dot:"",dotStyle:{width:"5px",height:"5px"}},{default:u(()=>[H(_.$slots,"default")]),_:3},8,["count"])}}});const W=A({__name:"f_nav_msg",setup(f){const t=L();function _(r){O.push({name:r})}return t.isLogin&&t.unReadMsg(),(r,e)=>{const g=p("a-doption"),m=p("a-dropdown");return d(),I(S,{count:l(t).unReadMsgAll,class:"f_nav_msg_com"},{default:u(()=>[s(m,{class:"f_nav_msg_dropdown",onSelect:_},{content:u(()=>[s(g,{value:"msgComment"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.commentMsgCount},{default:u(()=>e[0]||(e[0]=[y("\u8BC4\u8BBA\u548C@")])),_:1,__:[0]},8,["count"])]),_:1}),s(g,{value:"msgDigg"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.diggMsgCount},{default:u(()=>e[1]||(e[1]=[y("\u8D5E\u548C\u6536\u85CF")])),_:1,__:[1]},8,["count"])]),_:1}),s(g,{value:"msgChat"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.privateMsgCount},{default:u(()=>e[2]||(e[2]=[y("\u7528\u6237\u79C1\u4FE1")])),_:1,__:[2]},8,["count"])]),_:1}),s(g,{value:"msgSystem"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.systemMsgCount},{default:u(()=>e[3]||(e[3]=[y("\u7CFB\u7EDF\u901A\u77E5")])),_:1,__:[3]},8,["count"])]),_:1})]),default:u(()=>[e[4]||(e[4]=n("a",{href:"javascript:void 0"},"\u6D88\u606F",-1))]),_:1,__:[4]})]),_:1},8,["count"])}}});const X={class:"f_nav_avatar_com"},Y={class:"avatar"},Z={class:"nickname"},ee={class:"data"},ne={class:"menu"},te={class:"exit"},se=A({__name:"f_nav_avatar",setup(f){const t=L();function _(r){if(r==="exit"){t.userLogout();return}O.push({name:r})}return(r,e)=>{const g=p("a-avatar"),m=p("a-typography-text"),v=p("a-statistic"),k=p("a-trigger");return l(t).isLogin?(d(),I(k,{key:1,class:"f_nav_avatar_trigger","animation-name":"fade",trigger:"click","unmount-on-close":!1},{content:u(()=>[n("div",X,[n("div",Y,[s(g,{onClick:e[0]||(e[0]=i=>l(z)(l(t).userInfo.userID)),"image-url":l(t).userInfo.avatar,size:60},{default:u(()=>[y(F(l(t).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),n("div",Z,[s(m,{onClick:e[1]||(e[1]=i=>l(z)(l(t).userInfo.userID)),ellipsis:{rows:1,css:!0}},{default:u(()=>[y(F(l(t).userInfo.nickName),1)]),_:1})]),n("div",ee,[s(v,{extra:"\u7C89\u4E1D",value:l(t).userInfo.fansCount},null,8,["value"]),s(v,{extra:"\u5173\u6CE8",value:l(t).userInfo.followingCount},null,8,["value"]),s(v,{extra:"\u6587\u7AE0",value:l(t).userInfo.articleCount},null,8,["value"])]),n("div",ne,[n("div",{class:"item",onClick:e[2]||(e[2]=i=>_("userCenterInfo"))},e[8]||(e[8]=[n("i",{class:"iconfont icon-list"},null,-1),y(),n("span",null,"\u4E2A\u4EBA\u4E2D\u5FC3",-1)])),n("div",{class:"item",onClick:e[3]||(e[3]=i=>_("platformArticle"))},e[9]||(e[9]=[n("i",{class:"iconfont icon-wenzhangguanli"},null,-1),n("span",null,"\u6587\u7AE0\u7BA1\u7406",-1)])),n("div",{class:"item",onClick:e[4]||(e[4]=i=>_("msgChat"))},e[10]||(e[10]=[n("i",{class:"iconfont icon-xiaoxi"},null,-1),y(),n("span",null,"\u6211\u7684\u6D88\u606F",-1)])),l(t).isAdmin?(d(),b("div",{key:0,class:"item",onClick:e[5]||(e[5]=i=>_("home"))},e[11]||(e[11]=[n("i",{class:"iconfont icon-list"},null,-1),y(),n("span",null,"\u540E\u53F0\u7BA1\u7406",-1)]))):D("",!0)]),n("div",te,[n("div",{class:"item",onClick:e[6]||(e[6]=i=>_("exit"))},e[12]||(e[12]=[n("i",{class:"iconfont icon-liulanliang"},null,-1),y(),n("span",null,"\u9000\u51FA",-1)]))])])]),default:u(()=>[s(g,{class:"avatar_1","image-url":l(t).userInfo.avatar,size:30},{default:u(()=>[y(F(l(t).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),_:1})):(d(),I(g,{key:0,class:"avatar_1",size:30,onClick:l(U)},{default:u(()=>e[7]||(e[7]=[y("\u767B\u5F55")])),_:1,__:[7]},8,["onClick"]))}}});function Ee(f){return R.get("/api/search/article",{params:f})}function Le(f){return R.get("/api/search/tags",{params:f})}function oe(f){return R.get("/api/search/text",{params:f})}const ae={class:"head"},ue={class:"body"},le={class:"list scrollbar"},ie=["onClick"],re=["innerHTML"],ce=["innerHTML"],_e={key:0,class:"page"},de=A({__name:"f_text_search_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{expose:t,emit:_}){const r=f,e=_;function g(){m.key="",v.list=[],v.count=0,e("update:visible",!1)}const m=E({key:""}),v=E({list:[],count:0}),k=$(!1);async function i(){k.value=!1;const o=await oe(m);if(o.code){T.error(o.msg);return}Object.assign(v,o.data),k.value=!0}function h(o){m.key=o,i()}const w=$();function a(){m.key===""&&j(()=>{w.value.focus()})}function c(o){window.open(`/article/${o.articleID}?id=${o.flag}`,"_blank")}return t({setSearch:h}),(o,C)=>{const x=p("a-input"),V=p("a-button"),B=p("a-modal");return d(),I(B,{title:"\u5168\u6587\u641C\u7D22",onBeforeOpen:a,footer:!1,"body-class":"f_article_search_modal_body",visible:r.visible,onCancel:g},{default:u(()=>[n("div",ae,[s(x,{ref_key:"textRef",ref:w,modelValue:m.key,"onUpdate:modelValue":C[0]||(C[0]=M=>m.key=M),onKeydown:N(i,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9"},null,8,["modelValue"]),s(V,{onClick:i,type:"primary"},{default:u(()=>C[1]||(C[1]=[y("\u641C\u7D22")])),_:1,__:[1]})]),n("div",ue,[n("div",le,[(d(!0),b(q,null,K(v.list,M=>(d(),b("div",{class:"item",onClick:Fe=>c(M)},[n("div",{class:"title",innerHTML:M.head},null,8,re),n("div",{class:"abs",innerHTML:M.body},null,8,ce)],8,ie))),256))]),k.value?(d(),b("div",_e," \u5171\u641C\u7D22\u5230\u7ED3\u679C"+F(v.list.length)+"\u6761 ",1)):D("",!0)])]),_:1},8,["visible"])}}});const fe={class:"body scrollbar"},ve=["innerHTML"],pe={key:1,class:"chat"},me={class:"menu"},ge={class:"info"},ye=A({__name:"f_ai_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{emit:t}){const _=L(),r=$([]),e=f,g=t;function m(){r.value=[],g("update:visible",!1)}async function v(){if(!_.isLogin){T.warning("\u8BF7\u767B\u5F55"),U();return}r.value.push({isMe:!0,nickname:_.userInfo.nickName,avatar:_.userInfo.avatar,content:w.value});const a=E({isMe:!1,nickname:i.nickname,avatar:i.avatar,content:""}),c=new EventSource(`/api/ai_search?content=${w.value}&token=${_.userInfo.token}`);c.onopen=o=>{console.log("eventSource open: ",o)},c.onmessage=o=>{const C=JSON.parse(o.data);a.content+=C.data,console.log(C)},c.onerror=o=>{console.warn("eventSource error: ",o),c.close()},c.addEventListener("close",function(o){console.log(o)}),r.value.push(a),w.value=""}const k=$(),i=E({isMe:!1,nickname:"",avatar:"",content:""});async function h(){r.value=[],i.content="";const a=await J();if(a.code){T.error(a.msg);return}Object.assign(i,a.data),i.avatar="/aiLogo.png",r.value.push(i);const c=a.data.abstract.split("");for(let o=0;o<c.length;o++)setTimeout(()=>{i.content+=c[o]},40*o);j(()=>{k.value.focus()})}const w=$("");return(a,c)=>{const o=p("a-avatar"),C=p("a-textarea"),x=p("a-button"),V=p("a-modal");return d(),I(V,{onBeforeOpen:h,footer:!1,"modal-class":"f_ai_modal",visible:e.visible,onCancel:m},{default:u(()=>[n("div",fe,[(d(!0),b(q,null,K(r.value,B=>(d(),b("div",{class:G(["item",{isMe:B.isMe}])},[s(o,{"image-url":B.avatar},null,8,["image-url"]),B.isMe?(d(),b("div",pe,F(B.content),1)):(d(),b("div",{key:0,class:"chat",innerHTML:B.content},null,8,ve))],2))),256))]),n("div",me,[s(C,{ref_key:"textareaRef",ref:k,"auto-size":{minRows:4,maxRows:4},modelValue:w.value,"onUpdate:modelValue":c[0]||(c[0]=B=>w.value=B),onKeydown:N(v,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u4F60\u611F\u5174\u8DA3\u7684\u5185\u5BB9"},null,8,["modelValue"]),n("div",ge,[c[2]||(c[2]=n("span",null,"\u6309Enter\u53D1\u9001\uFF0C\u6309Ctrl+Enter\u6362\u884C",-1)),s(x,{onClick:v,type:"primary"},{default:u(()=>c[1]||(c[1]=[y("\u53D1\u9001")])),_:1,__:[1]})])])]),_:1},8,["visible"])}}});const ke={class:"nav-inner"},Ce={class:"nav-left"},be={class:"n2"},xe={class:"nav-center"},$e={class:"nav-right"},Ve=A({__name:"f_nav",props:{noScroll:{type:Boolean},scrollTop:{}},setup(f){const t=L(),_=f,{noScroll:r=!1,scrollTop:e=200}=_,g=$(r);r||(window.onscroll=()=>{g.value=document.documentElement.scrollTop>=e});const m=$(!1),v=$(""),k=$();function i(){m.value=!0,v.value&&k.value.setSearch(v.value)}const h=$(!1);return(w,a)=>{const c=p("a-input-search"),o=p("router-link"),C=p("a-button");return d(),b("div",{class:G(["f_nav",{isShow:g.value}])},[n("div",ke,[n("div",Ce,[a[4]||(a[4]=n("a",{href:"/",class:"brand"},[n("span",{class:"n1"},"GenerationBlog")],-1)),n("span",be,F(l(t).siteInfo.siteInfo.mode===1?"\u793E\u533A\u7248":"\u535A\u5BA2\u7248"),1),s(P,{class:"theme-switch"})]),n("div",xe,[l(t).siteInfo.ai.enable?(d(),b("i",{key:0,onClick:a[0]||(a[0]=x=>h.value=!0),class:"iconfont icon-dengpao"})):D("",!0),s(c,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=x=>v.value=x),onSearch:i,onKeydown:N(i,["enter"]),placeholder:"\u641C\u7D22\u4F60\u559C\u6B22\u7684\u6587\u7AE0"},null,8,["modelValue"])]),n("div",$e,[s(se),s(W),s(o,{class:"history",to:{name:"userCenterHistory"}},{default:u(()=>a[5]||(a[5]=[y("\u5386\u53F2")])),_:1,__:[5]}),s(o,{to:{name:"platformArticleAdd"}},{default:u(()=>[s(C,{type:"primary",class:"post-btn"},{default:u(()=>a[6]||(a[6]=[n("i",{class:"iconfont icon-jia"},null,-1),n("span",null,"\u53D1\u5E03",-1)])),_:1,__:[6]})]),_:1})])]),l(t).siteInfo.ai.enable?(d(),I(ye,{key:0,visible:h.value,"onUpdate:visible":a[2]||(a[2]=x=>h.value=x)},null,8,["visible"])):D("",!0),s(de,{ref_key:"textSearchRef",ref:k,visible:m.value,"onUpdate:visible":a[3]||(a[3]=x=>m.value=x)},null,8,["visible"])],2)}}});const we={},Be={class:"f_main_com"},he={class:"f_container"};function Ie(f,t){return d(),b("div",Be,[n("div",he,[H(f.$slots,"default")])])}const Te=Q(we,[["render",Ie]]);export{Te as F,Ve as _,Ee as a,Le as t};
