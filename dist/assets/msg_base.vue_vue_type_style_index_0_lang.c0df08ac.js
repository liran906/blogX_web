import{d as k,a as B,r as _,o as p,e as m,h as u,f as o,w as n,F as x,g as M,i as S,ar as z,M as r,as as D,at as v,k as g,x as N,t as V,u as C,a4 as R}from"./index.402bb782.js";import{b as $}from"./date.c30b11a9.js";const h={class:"f_msg_base_com"},L={class:"msg-header"},I={class:"action-buttons"},T={class:"list"},U={class:"action"},j={class:"date"},q={class:"more"},G={key:0,class:"page"},K=k({__name:"msg_base",props:{t:{}},setup(w){const i=w,d=B({list:[],count:0}),l=B({t:i.t,limit:10,page:1});async function c(){const e=await z(l);if(e.code){r.error(e.msg);return}d.list=e.data.list,d.count=e.data.count}c();async function A(e,t){let s;if(e==="read"?s=await D({id:t,t:i.t}):s=await v({id:t,t:i.t}),s.code){r.error(s.msg);return}r.success(s.msg),c()}async function f(e){let t;if(!(e==="delete"&&!window.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F\u6B64\u64CD\u4F5C\u4EC5\u4F1A\u5220\u9664\u6D88\u606F\u901A\u77E5")))try{if(e==="read"?t=await D({id:0,t:i.t}):t=await v({id:0,t:i.t}),t.code){r.error(t.msg||(e==="read"?"\u6807\u8BB0\u4E3A\u5DF2\u8BFB\u5931\u8D25":"\u5220\u9664\u5931\u8D25"));return}r.success(e==="read"?"\u5168\u90E8\u6807\u8BB0\u4E3A\u5DF2\u8BFB":"\u5168\u90E8\u6D88\u606F\u5DF2\u5220\u9664"),c()}catch(s){console.error(s),r.error("\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}}return(e,t)=>{const s=_("a-button"),F=_("a-doption"),E=_("a-dropdown"),y=_("a-pagination");return p(),m("div",h,[u("div",L,[t[5]||(t[5]=u("div",null,null,-1)),u("div",I,[o(s,{size:"small",type:"text",onClick:t[0]||(t[0]=a=>f("read"))},{default:n(()=>t[3]||(t[3]=[g("\u5168\u90E8\u6807\u8BB0\u4E3A\u5DF2\u8BFB")])),_:1,__:[3]}),o(s,{size:"small",type:"text",status:"danger",onClick:t[1]||(t[1]=a=>f("delete"))},{default:n(()=>t[4]||(t[4]=[g("\u5168\u90E8\u5220\u9664")])),_:1,__:[4]})])]),u("div",T,[(p(!0),m(x,null,M(d.list,a=>(p(),m("div",{class:"item",key:a.id},[N(e.$slots,"default",{item:a}),u("div",U,[u("span",j,V(C($)(a.createdAt)),1),u("span",q,[o(E,{onSelect:b=>A(b,a.id)},{content:n(()=>[o(F,{value:"read",disabled:a.isRead},{default:n(()=>t[6]||(t[6]=[g("\u8BFB\u53D6\u6D88\u606F")])),_:2,__:[6]},1032,["disabled"]),o(F,{value:"delete"},{default:n(()=>t[7]||(t[7]=[g("\u5220\u9664\u6D88\u606F")])),_:1,__:[7]})]),default:n(()=>[o(C(R))]),_:2},1032,["onSelect"])])])]))),128))]),d.list.length?(p(),m("div",G,[o(y,{"page-size":l.limit,total:d.count,"show-total":"",current:l.page,"onUpdate:current":t[2]||(t[2]=a=>l.page=a),onChange:c},null,8,["page-size","total","current"])])):S("",!0)])}}});export{K as _};
