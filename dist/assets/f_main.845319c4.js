import{d as A,r as m,o as d,c as I,w as u,x as z,p as L,u as l,f as s,k as y,h as n,m as H,s as O,t as F,e as b,i as D,q as T,a as E,b as w,y as U,j as R,g as j,F as K,M as V,z as J,n as q}from"./index.402bb782.js";import{g as N}from"./go_router.9df53f96.js";import{_ as P}from"./f_avatar.vue_vue_type_script_setup_true_lang.bba7e2c0.js";/* empty css                                                 */import{_ as Q}from"./f_theme.vue_vue_type_script_setup_true_lang.c5bc89c7.js";import{_ as W}from"./_plugin-vue_export-helper.cdc0426e.js";const S=A({__name:"f_point",props:{count:{}},setup(f){const t=f;return(_,r)=>{const e=m("a-badge");return d(),I(e,{class:"f_point_com",count:t.count,dot:"",dotStyle:{width:"5px",height:"5px"}},{default:u(()=>[z(_.$slots,"default")]),_:3},8,["count"])}}});const X=A({__name:"f_nav_msg",setup(f){const t=L();function _(r){H.push({name:r})}return t.isLogin&&t.unReadMsg(),(r,e)=>{const g=m("a-doption"),p=m("a-dropdown");return d(),I(S,{count:l(t).unReadMsgAll,class:"f_nav_msg_com"},{default:u(()=>[s(p,{class:"f_nav_msg_dropdown",onSelect:_},{content:u(()=>[s(g,{value:"msgComment"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.commentMsgCount},{default:u(()=>e[0]||(e[0]=[y("\u8BC4\u8BBA\u548C@")])),_:1,__:[0]},8,["count"])]),_:1}),s(g,{value:"msgDigg"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.diggMsgCount},{default:u(()=>e[1]||(e[1]=[y("\u8D5E\u548C\u6536\u85CF")])),_:1,__:[1]},8,["count"])]),_:1}),s(g,{value:"msgChat"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.privateMsgCount},{default:u(()=>e[2]||(e[2]=[y("\u7528\u6237\u79C1\u4FE1")])),_:1,__:[2]},8,["count"])]),_:1}),s(g,{value:"msgSystem"},{default:u(()=>[s(S,{count:l(t).unMsgInfo.systemMsgCount},{default:u(()=>e[3]||(e[3]=[y("\u7CFB\u7EDF\u901A\u77E5")])),_:1,__:[3]},8,["count"])]),_:1})]),default:u(()=>[e[4]||(e[4]=n("a",{href:"javascript:void 0"},"\u6D88\u606F",-1))]),_:1,__:[4]})]),_:1},8,["count"])}}});const Y={class:"f_nav_avatar_com"},Z={class:"avatar"},ee={class:"nickname"},ne={class:"data"},te={class:"menu"},se={class:"exit"},oe=A({__name:"f_nav_avatar",setup(f){const t=L();function _(r){if(r==="exit"){t.userLogout();return}H.push({name:r})}return(r,e)=>{const g=m("a-avatar"),p=m("a-typography-text"),v=m("a-statistic"),k=m("a-trigger");return l(t).isLogin?(d(),I(k,{key:1,class:"f_nav_avatar_trigger","animation-name":"fade",trigger:"click","unmount-on-close":!1},{content:u(()=>[n("div",Y,[n("div",Z,[s(g,{onClick:e[0]||(e[0]=i=>l(N)(l(t).userInfo.userID)),"image-url":l(t).userInfo.avatar,size:60},{default:u(()=>[y(F(l(t).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),n("div",ee,[s(p,{onClick:e[1]||(e[1]=i=>l(N)(l(t).userInfo.userID)),ellipsis:{rows:1,css:!0}},{default:u(()=>[y(F(l(t).userInfo.nickName),1)]),_:1})]),n("div",ne,[s(v,{extra:"\u7C89\u4E1D",value:l(t).userInfo.fansCount},null,8,["value"]),s(v,{extra:"\u5173\u6CE8",value:l(t).userInfo.followingCount},null,8,["value"]),s(v,{extra:"\u6587\u7AE0",value:l(t).userInfo.articleCount},null,8,["value"])]),n("div",te,[n("div",{class:"item",onClick:e[2]||(e[2]=i=>_("userCenterInfo"))},e[8]||(e[8]=[n("i",{class:"iconfont icon-list"},null,-1),y(),n("span",null,"\u4E2A\u4EBA\u4E2D\u5FC3",-1)])),n("div",{class:"item",onClick:e[3]||(e[3]=i=>_("platformArticle"))},e[9]||(e[9]=[n("i",{class:"iconfont icon-wenzhangguanli"},null,-1),n("span",null,"\u6587\u7AE0\u7BA1\u7406",-1)])),n("div",{class:"item",onClick:e[4]||(e[4]=i=>_("msgChat"))},e[10]||(e[10]=[n("i",{class:"iconfont icon-xiaoxi"},null,-1),y(),n("span",null,"\u6211\u7684\u6D88\u606F",-1)])),l(t).isAdmin?(d(),b("div",{key:0,class:"item",onClick:e[5]||(e[5]=i=>_("home"))},e[11]||(e[11]=[n("i",{class:"iconfont icon-list"},null,-1),y(),n("span",null,"\u540E\u53F0\u7BA1\u7406",-1)]))):D("",!0)]),n("div",se,[n("div",{class:"item",onClick:e[6]||(e[6]=i=>_("exit"))},e[12]||(e[12]=[n("i",{class:"iconfont icon-liulanliang"},null,-1),y(),n("span",null,"\u9000\u51FA",-1)]))])])]),default:u(()=>[s(g,{class:"avatar_1","image-url":l(t).userInfo.avatar,size:30},{default:u(()=>[y(F(l(t).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),_:1})):(d(),I(g,{key:0,class:"avatar_1",size:30,onClick:l(O)},{default:u(()=>e[7]||(e[7]=[y("\u767B\u5F55")])),_:1,__:[7]},8,["onClick"]))}}});function Te(f){return T.get("/api/search/article",{params:f})}function Re(f){return T.get("/api/search/tags",{params:f})}function ae(f){return T.get("/api/search/text",{params:f})}const ue={class:"head"},le={class:"body"},ie={class:"list scrollbar"},re=["onClick"],ce=["innerHTML"],_e=["innerHTML"],de={key:0,class:"page"},fe=A({__name:"f_text_search_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{expose:t,emit:_}){const r=f,e=_;function g(){p.key="",v.list=[],v.count=0,e("update:visible",!1)}const p=E({key:""}),v=E({list:[],count:0}),k=w(!1);async function i(){k.value=!1;const o=await ae(p);if(o.code){V.error(o.msg);return}Object.assign(v,o.data),k.value=!0}function h(o){p.key=o,i()}const B=w();function a(){p.key===""&&U(()=>{B.value.focus()})}function c(o){window.open(`/article/${o.articleID}?id=${o.flag}`,"_blank")}return t({setSearch:h}),(o,C)=>{const x=m("a-input"),$=m("a-button"),G=m("a-modal");return d(),I(G,{title:"\u5168\u6587\u641C\u7D22",onBeforeOpen:a,footer:!1,"body-class":"f_article_search_modal_body",visible:r.visible,onCancel:g},{default:u(()=>[n("div",ue,[s(x,{ref_key:"textRef",ref:B,modelValue:p.key,"onUpdate:modelValue":C[0]||(C[0]=M=>p.key=M),onKeydown:R(i,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9"},null,8,["modelValue"]),s($,{onClick:i,type:"primary"},{default:u(()=>C[1]||(C[1]=[y("\u641C\u7D22")])),_:1,__:[1]})]),n("div",le,[n("div",ie,[(d(!0),b(K,null,j(v.list,M=>(d(),b("div",{class:"item",onClick:Ae=>c(M)},[n("div",{class:"title",innerHTML:M.head},null,8,ce),n("div",{class:"abs",innerHTML:M.body},null,8,_e)],8,re))),256))]),k.value?(d(),b("div",de," \u5171\u641C\u7D22\u5230\u7ED3\u679C"+F(v.list.length)+"\u6761 ",1)):D("",!0)])]),_:1},8,["visible"])}}});const ve={class:"body scrollbar"},pe=["innerHTML"],me={key:1,class:"chat"},ge={class:"menu"},ye={class:"info"},ke=A({__name:"f_ai_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{emit:t}){const _=L(),r=w([]),e=f,g=t;function p(){r.value=[],g("update:visible",!1)}async function v(){if(!_.isLogin){V.warning("\u8BF7\u767B\u5F55"),O();return}r.value.push({isMe:!0,nickname:_.userInfo.nickName,avatar:_.userInfo.avatar,content:B.value});const a=E({isMe:!1,nickname:i.nickname,avatar:i.avatar,content:""}),c=new EventSource(`/api/ai_search?content=${B.value}&token=${_.userInfo.token}`);c.onopen=o=>{console.log("eventSource open: ",o)},c.onmessage=o=>{const C=JSON.parse(o.data);a.content+=C.data,console.log(C)},c.onerror=o=>{console.warn("eventSource error: ",o),c.close()},c.addEventListener("close",function(o){console.log(o)}),r.value.push(a),B.value=""}const k=w(),i=E({isMe:!1,nickname:"",avatar:"",content:""});async function h(){r.value=[],i.content="";const a=await J();if(a.code){V.error(a.msg);return}Object.assign(i,a.data),i.avatar="/aiLogo.png",r.value.push(i);const c=a.data.abstract.split("");for(let o=0;o<c.length;o++)setTimeout(()=>{i.content+=c[o]},40*o);U(()=>{k.value.focus()})}const B=w("");return(a,c)=>{const o=m("a-textarea"),C=m("a-button"),x=m("a-modal");return d(),I(x,{onBeforeOpen:h,footer:!1,"modal-class":"f_ai_modal",visible:e.visible,onCancel:p},{default:u(()=>[n("div",ve,[(d(!0),b(K,null,j(r.value,$=>(d(),b("div",{class:q(["item",{isMe:$.isMe}])},[s(P,{"image-url":$.avatar,nickname:$.nickname},null,8,["image-url","nickname"]),$.isMe?(d(),b("div",me,F($.content),1)):(d(),b("div",{key:0,class:"chat",innerHTML:$.content},null,8,pe))],2))),256))]),n("div",ge,[s(o,{ref_key:"textareaRef",ref:k,"auto-size":{minRows:4,maxRows:4},modelValue:B.value,"onUpdate:modelValue":c[0]||(c[0]=$=>B.value=$),onKeydown:R(v,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u4F60\u611F\u5174\u8DA3\u7684\u5185\u5BB9"},null,8,["modelValue"]),n("div",ye,[c[2]||(c[2]=n("span",null,"\u6309Enter\u53D1\u9001\uFF0C\u6309Ctrl+Enter\u6362\u884C",-1)),s(C,{onClick:v,type:"primary"},{default:u(()=>c[1]||(c[1]=[y("\u53D1\u9001")])),_:1,__:[1]})])])]),_:1},8,["visible"])}}});const Ce={class:"nav-inner"},be={class:"nav-left"},xe={class:"n2"},$e={class:"nav-center"},we={class:"nav-right"},Ne=A({__name:"f_nav",props:{noScroll:{type:Boolean},scrollTop:{}},setup(f){const t=L(),_=f,{noScroll:r=!1,scrollTop:e=200}=_,g=w(r);r||(window.onscroll=()=>{g.value=document.documentElement.scrollTop>=e});const p=w(!1),v=w(""),k=w();function i(){p.value=!0,v.value&&k.value.setSearch(v.value)}const h=w(!1);return(B,a)=>{const c=m("a-input-search"),o=m("router-link"),C=m("a-button");return d(),b("div",{class:q(["f_nav",{isShow:g.value}])},[n("div",Ce,[n("div",be,[a[4]||(a[4]=n("a",{href:"/",class:"brand"},[n("span",{class:"n1"},"GenerationBlog")],-1)),n("span",xe,F(l(t).siteInfo.siteInfo.mode===1?"\u793E\u533A\u7248":"\u535A\u5BA2\u7248"),1),s(Q,{class:"theme-switch"})]),n("div",$e,[l(t).siteInfo.ai.enable?(d(),b("i",{key:0,onClick:a[0]||(a[0]=x=>h.value=!0),class:"iconfont icon-dengpao"})):D("",!0),s(c,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=x=>v.value=x),onSearch:i,onKeydown:R(i,["enter"]),placeholder:"\u641C\u7D22\u4F60\u559C\u6B22\u7684\u6587\u7AE0"},null,8,["modelValue"])]),n("div",we,[s(oe),s(X),s(o,{class:"history",to:{name:"userCenterHistory"}},{default:u(()=>a[5]||(a[5]=[y("\u5386\u53F2")])),_:1,__:[5]}),s(o,{to:{name:"platformArticleAdd"}},{default:u(()=>[s(C,{type:"primary",class:"post-btn"},{default:u(()=>a[6]||(a[6]=[n("i",{class:"iconfont icon-jia"},null,-1),n("span",null,"\u53D1\u5E03",-1)])),_:1,__:[6]})]),_:1})])]),l(t).siteInfo.ai.enable?(d(),I(ke,{key:0,visible:h.value,"onUpdate:visible":a[2]||(a[2]=x=>h.value=x)},null,8,["visible"])):D("",!0),s(fe,{ref_key:"textSearchRef",ref:k,visible:p.value,"onUpdate:visible":a[3]||(a[3]=x=>p.value=x)},null,8,["visible"])],2)}}});const Be={},he={class:"f_main_com"},Ie={class:"f_container"};function Fe(f,t){return d(),b("div",he,[n("div",Ie,[z(f.$slots,"default")])])}const ze=W(Be,[["render",Fe]]);export{ze as F,Ne as _,Te as a,Re as t};
